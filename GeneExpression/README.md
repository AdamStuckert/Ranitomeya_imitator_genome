### Gene expression analyses

This folder documents work done to analyze our gene expression after assembling the genome. We parameterized aligning and counting RNA seq reads using `STAR` and `htseq-count.` For details on this, please see the [GeneExpressionWorkbook.md](https://github.com/AdamStuckert/Ranitomeya_imitator_genome/blob/master/GeneExpression/GeneExpressionWorkbook.md) file. We used a number of scripts we wrote for this purpose in the parameterization process, notably scripts to [index the genome, align reads, and count expression](https://github.com/AdamStuckert/Ranitomeya_imitator_genome/blob/master/GeneExpression/STAR.sh). We have additionally deposited scripts to [extract mapping rates and other statistics for each sample](https://github.com/AdamStuckert/Ranitomeya_imitator_genome/blob/master/GeneExpression/STARdata.sh) and scripts to [automate summary statistics on these mapping statistics](https://github.com/AdamStuckert/Ranitomeya_imitator_genome/blob/master/GeneExpression/ReadMappingStats.R) within this directory.

Following this we conducted differential expression analyses using the R package DESeq2. We have a [detailed R markdown file of our differential expression analyses](https://github.com/AdamStuckert/Ranitomeya_imitator_genome/blob/master/GeneExpression/MimeticGeneExpressionGeneLevel.Rmd). In addition to doing analyses, this script produces a number of the figures in the publication. Relevant data for this script (e.g., gene counts for each sample, genome annotation documents used) are all in the `./data/` directory. 


*Please note that in the code laid out here we utilize an approach that uses a fasta file with annotation in gff3 format for the gene expression analyses contained in this subdirectory. If you are downloading the genome assembly from ENA/NCBI to use for gene expression analyses the assembly will 1) have a different name and 2) be in the EMBL flat format with no separate gff3 file containing annotation data. This difference occurs because the ENA requires genome assemblies to be submitted in EMBL format. Thus, anyone using the code laid out in this gene expression workbook will need to modify the STAR code appropriately.*
